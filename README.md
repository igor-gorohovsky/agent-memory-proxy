# Agent Memory Proxy

A unified memory management solution for AI code agents (Claude, Gemini, Cursor, etc.)

## üéØ Problem

The AI/LLM industry is evolving rapidly, and developers now have access to numerous code agents. However, each agent uses different approaches to managing "memory" (context files, project rules, etc.), making it challenging to maintain unified project memory across different tools.

## üí° Solution

Agent Memory Proxy provides a "proxy" layer that automatically synchronizes a single memory file with various agent-specific formats. You maintain one `MEMORY.md` file, and the proxy handles the adaptation to different agent formats automatically.

## ‚ú® Key Features

- **Single Source of Truth**: Maintain one memory file that syncs to all agents
- **Automatic Synchronization**: File watcher detects changes and updates agent-specific files
- **Multi-Agent Support**: Works with Claude, Gemini, Cursor, and easily extensible to others
- **Cross-Platform**: Runs on Windows, macOS, Linux, and WSL
- **Lightweight**: Minimal dependencies, runs in the background
- **Git-Friendly**: Generated files can be gitignored to avoid conflicts

## üìã Requirements

- Python 3.8+
- Poetry (Python dependency management) - [Installation guide](https://python-poetry.org/docs/#installation)

## üöÄ Quick Start

### 1. Installation

#### Option 1: Using Poetry (Recommended)

```bash
# Clone the repository
git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
cd agent-memory-proxy

# Install Poetry if you haven't already
curl -sSL https://install.python-poetry.org | python3 -

# Install dependencies
poetry install

# Run the proxy
poetry run amp
```

#### Option 2: Using pip

```bash
# Clone the repository
git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
cd agent-memory-proxy

# Install from pyproject.toml
pip install .

# Or install in development mode
pip install -e .
```

### 2. Configuration

Create a `.amp.yaml` file in your project directory:

```yaml
mappings:
  # Map agent-specific files to your main memory file
  CLAUDE.md: MEMORY.md
  GEMINI.md: MEMORY.md
  .cursor/rules/project.mdc: MEMORY.md
  .github/copilot/project-context.md: MEMORY.md
```

### 3. Set Environment Variable

Add directories to watch (separated by platform-specific path separator):

#### Windows (PowerShell)
```powershell
$env:AGENT_MEMORY_PATHS = "C:\projects\my-app;C:\projects\another-app"
```

#### Windows (Command Prompt)
```cmd
set AGENT_MEMORY_PATHS=C:\projects\my-app;C:\projects\another-app
```

#### macOS/Linux/WSL
```bash
export AGENT_MEMORY_PATHS="/home/user/projects:/home/user/work/specific_project"
```

### 4. Update .gitignore

Add agent-specific files to `.gitignore`:

```gitignore
# Agent-specific memory files (generated by proxy)
CLAUDE.md
GEMINI.md
.cursor/rules/project.mdc
```

### 5. Run the Proxy

```bash
poetry run amp
# Or with poetry environment:
poetry run python src/main.py
```

## üñ•Ô∏è Platform-Specific Setup

### Windows

#### Option 1: Task Scheduler (Recommended)
1. Create a batch file `start_memory_proxy.bat`:
   ```batch
   @echo off
   cd /d "C:\path\to\agent-memory-proxy"
   REM Ensure Poetry is installed and in PATH first
   poetry run amp
   ```

2. Open Task Scheduler and create a new task:
   - Trigger: At log on
   - Action: Start `start_memory_proxy.bat`
   - Settings: Run whether user is logged on or not

#### Option 2: Windows Service
Use [NSSM](https://nssm.cc/) to install as a service:

**Note**: Ensure Poetry is installed and dependencies are installed first via `poetry install`.

```cmd
nssm install AgentMemoryProxy "C:\path\to\poetry.exe" "run amp"
nssm set AgentMemoryProxy AppDirectory "C:\path\to\agent-memory-proxy"
nssm start AgentMemoryProxy
```

#### Option 3: Startup Folder
Place the batch file in:
```
Win+R ‚Üí shell:startup
```

### macOS

#### Option 1: launchd (Recommended)
1. Create `~/Library/LaunchAgents/com.agent-memory-proxy.plist`:
   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
   <plist version="1.0">
   <dict>
       <key>Label</key>
       <string>com.agent-memory-proxy</string>
       <key>ProgramArguments</key>
       <array>
           <string>/usr/local/bin/poetry</string>
           <string>run</string>
           <string>amp</string>
       </array>
       <key>WorkingDirectory</key>
       <string>/path/to/agent-memory-proxy</string>
       <key>RunAtLoad</key>
       <true/>
       <key>KeepAlive</key>
       <true/>
       <key>EnvironmentVariables</key>
       <dict>
           <key>AGENT_MEMORY_PATHS</key>
           <string>/Users/you/projects</string>
       </dict>
   </dict>
   </plist>
   ```

2. Load the service:
   ```bash
   launchctl load ~/Library/LaunchAgents/com.agent-memory-proxy.plist
   ```

#### Option 2: Login Items
Add to Login Items in System Preferences ‚Üí Users & Groups

### Linux

#### Option 1: systemd (Recommended)

**Note**: Ensure Poetry is installed and run `poetry install` in the project directory first.

1. Create `/etc/systemd/system/agent-memory-proxy.service`:
   ```ini
   [Unit]
   Description=Agent Memory Proxy
   After=network.target

   [Service]
   Type=simple
   User=yourusername
   Environment="AGENT_MEMORY_PATHS=/home/yourusername/projects"
   WorkingDirectory=/path/to/agent-memory-proxy
   ExecStart=/usr/local/bin/poetry run amp
   Restart=always

   [Install]
   WantedBy=multi-user.target
   ```

2. Enable and start:
   ```bash
   sudo systemctl enable agent-memory-proxy
   sudo systemctl start agent-memory-proxy
   ```

#### Option 2: cron
```bash
crontab -e
# Add:
@reboot cd /path/to/agent-memory-proxy && AGENT_MEMORY_PATHS="/home/user/projects" /usr/local/bin/poetry run amp
```

### WSL (Windows Subsystem for Linux)

Since WSL doesn't have systemd by default, use one of these approaches:

#### Option 1: Windows Task Scheduler
Create a task that runs:
```
wsl.exe -d Ubuntu -u yourusername -- bash -c "cd /path/to/agent-memory-proxy && AGENT_MEMORY_PATHS=/home/user/projects poetry run amp"
```

#### Option 2: Background Process
Add to `~/.bashrc` or `~/.zshrc`:
```bash
# Start agent memory proxy if not running
if ! pgrep -f "amp" > /dev/null; then
    export AGENT_MEMORY_PATHS="/home/user/projects"
    cd /path/to/agent-memory-proxy && nohup poetry run amp > ~/.agent-memory-proxy.log 2>&1 &
fi
```

## üìÅ Example Project Structure

```
my-project/
‚îú‚îÄ‚îÄ .amp.yaml                   # Configuration
‚îú‚îÄ‚îÄ MEMORY.md                   # Your single source of truth
‚îú‚îÄ‚îÄ CLAUDE.md                   # Generated (gitignored)
‚îú‚îÄ‚îÄ GEMINI.md                   # Generated (gitignored)
‚îú‚îÄ‚îÄ .cursor/
‚îÇ   ‚îî‚îÄ‚îÄ rules/
‚îÇ       ‚îî‚îÄ‚îÄ project.mdc         # Generated (gitignored)
‚îî‚îÄ‚îÄ .gitignore
```

## üîß Advanced Configuration

### Multiple Memory Files

You can map different source files to different targets:

```yaml
mappings:
  CLAUDE.md: MEMORY.md
  GEMINI.md: MEMORY.md
  .cursor/rules/project.mdc: CURSOR_MEMORY.md
  docs/API_CONTEXT.md: API_DOCS.md
```

### Watching Multiple Projects

Set multiple paths in the environment variable:

```bash
# Unix-like (colon-separated)
export AGENT_MEMORY_PATHS="/project1:/project2:/project3"

# Windows (semicolon-separated)
set AGENT_MEMORY_PATHS=C:\project1;C:\project2;C:\project3
```

## üêõ Troubleshooting

### Proxy Not Detecting Changes
- Ensure the source file exists before starting the proxy
- Check file permissions
- Verify the config file is valid YAML
- Run with `--verbose` flag for detailed logs

### Permission Errors
- On Unix systems, ensure you have read/write permissions
- On Windows, run as Administrator if needed

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

### Development Setup

1. **Clone the repository**
   ```bash
   git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
   cd agent-memory-proxy
   ```

2. **Install Poetry**
   ```bash
   curl -sSL https://install.python-poetry.org | python3 -
   ```

3. **Install development dependencies**
   ```bash
   poetry install
   ```

4. **Run tests**
   ```bash
   poetry run pytest tests
   ```

### Development Workflow

1. Create a new branch for your feature
2. Make your changes
3. Add tests for new functionality
8. Submit a pull request

## üìÆ Support

For issues, questions, or suggestions:
- Open an issue on GitHub
- Check existing issues for solutions
- Read the logs with `--verbose` flag for debugging
