# Agent Memory Proxy

A unified memory management solution for AI code agents (Claude, Gemini, Cursor, etc.)

## üéØ Problem

The AI/LLM industry is evolving rapidly, and developers now have access to numerous code agents. However, each agent uses different approaches to managing "memory" (context files, project rules, etc.), making it challenging to maintain unified project memory across different tools.

## üí° Solution

Agent Memory Proxy provides a "proxy" layer that automatically synchronizes a single memory file with various agent-specific formats. You maintain one `AGENT.md` file, and the proxy handles the adaptation to different agent formats automatically.

## ‚ú® Key Features

- **Single Source of Truth**: Maintain one memory file that syncs to all agents
- **Automatic Synchronization**: File watcher detects changes and updates agent-specific files
- **Multi-Agent Support**: Works with Claude, Gemini, Cursor, and easily extensible to others
- **Cross-Platform**: Runs on Windows, macOS, Linux, and WSL
- **Lightweight**: Minimal dependencies, runs in the background
- **Git-Friendly**: Generated files can be gitignored to avoid conflicts

## üìã Requirements

- Python 3.9+
- uv (Python package manager) - [Installation guide](https://github.com/astral-sh/uv)

## üöÄ Quick Start

### 1. Installation

#### Option 1: Using uv (Recommended)

```bash
# Clone the repository
git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
cd agent-memory-proxy

# Install uv if you haven't already
curl -LsSf https://astral.sh/uv/install.sh | sh

# Install dependencies
uv sync

# Run the proxy
uv run amp
```

#### Option 2: Using pip

```bash
# Clone the repository
git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
cd agent-memory-proxy

# Install from pyproject.toml
pip install .

# Or install in development mode
pip install -e .
```

### 2. Configuration

Create a `.amp.yaml` file in your project directory:

```yaml
respect_gitignore: true
truth_memory_file: "AGENT.md"
agents:
  - claude
  - gemini
  - cursor
  - copilot
```

### 3. Set Environment Variable

Add directories to watch (separated by platform-specific path separator):

#### Windows (PowerShell)
```powershell
$env:AGENT_MEMORY_PATHS = "C:\projects\my-app;C:\projects\another-app"
```

#### Windows (Command Prompt)
```cmd
set AGENT_MEMORY_PATHS=C:\projects\my-app;C:\projects\another-app
```

#### macOS/Linux/WSL
```bash
export AGENT_MEMORY_PATHS="/home/user/projects:/home/user/work/specific_project"
```

### 4. Update .gitignore

Add agent-specific files to `.gitignore`:

```gitignore
# Agent-specific memory files (generated by proxy)
CLAUDE.md
GEMINI.md
.cursor/rules/project.mdc
```

### 5. Run the Proxy

Make sure to export the environment variable first:

```bash
# Set the paths to watch
export AGENT_MEMORY_PATHS="/path/to/your/projects"

# Run the proxy
uv run amp
```

## üñ•Ô∏è Platform-Specific Setup

### Windows

#### Option 1: Task Scheduler (Recommended)
1. Create a batch file `start_memory_proxy.bat`:
   ```batch
   @echo off
   cd /d "C:\path\to\agent-memory-proxy"
   REM Ensure uv is installed and in PATH first
   uv run amp
   ```

2. Open Task Scheduler and create a new task:
   - Trigger: At log on
   - Action: Start `start_memory_proxy.bat`
   - Settings: Run whether user is logged on or not

#### Option 2: Windows Service
Use [NSSM](https://nssm.cc/) to install as a service:

**Note**: Ensure uv is installed and dependencies are installed first via `uv sync`.

```cmd
nssm install AgentMemoryProxy "C:\path\to\uv.exe" "run amp"
nssm set AgentMemoryProxy AppDirectory "C:\path\to\agent-memory-proxy"
nssm start AgentMemoryProxy
```

#### Option 3: Startup Folder
Place the batch file in:
```
Win+R ‚Üí shell:startup
```

### macOS

#### Option 1: launchd (Recommended)
1. Create `~/Library/LaunchAgents/com.agent-memory-proxy.plist`:
   ```xml
   <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
   <plist version="1.0">
   <dict>
       <key>Label</key>
       <string>com.agent-memory-proxy</string>
       <key>ProgramArguments</key>
       <array>
           <string>/Users/you/.cargo/bin/uv</string>
           <string>run</string>
           <string>--directory</string>
           <string>/path/to/agent-memory-proxy</string>
           <string>amp</string>
       </array>
       <key>WorkingDirectory</key>
       <string>/path/to/agent-memory-proxy</string>
       <key>RunAtLoad</key>
       <true/>
       <key>KeepAlive</key>
       <true/>
       <key>EnvironmentVariables</key>
       <dict>
           <key>AGENT_MEMORY_PATHS</key>
           <string>/Users/you/projects</string>
       </dict>
   </dict>
   </plist>
   ```

2. Load the service:
   ```bash
   launchctl load ~/Library/LaunchAgents/com.agent-memory-proxy.plist
   ```

#### Option 2: Login Items
Add to Login Items in System Preferences ‚Üí Users & Groups

### Linux

#### Option 1: systemd (Recommended)

**Note**: Ensure uv is installed and run `uv sync` in the project directory first.

1. Create `/etc/systemd/system/agent-memory-proxy.service`:
   ```ini
   [Unit]
   Description=Agent Memory Proxy
   After=network.target

   [Service]
   Type=simple
   User=yourusername
   Environment="AGENT_MEMORY_PATHS=/home/yourusername/projects"
   WorkingDirectory=/path/to/agent-memory-proxy
   ExecStart=/home/yourusername/.cargo/bin/uv run amp
   Restart=always

   [Install]
   WantedBy=multi-user.target
   ```

2. Enable and start:
   ```bash
   sudo systemctl enable agent-memory-proxy
   sudo systemctl start agent-memory-proxy
   ```

#### Option 2: cron
```bash
crontab -e
# Add:
@reboot cd /path/to/agent-memory-proxy && AGENT_MEMORY_PATHS="/home/user/projects" /home/user/.cargo/bin/uv run amp
```

### WSL (Windows Subsystem for Linux)

Since WSL doesn't have systemd by default, use one of these approaches:

#### Option 1: Windows Task Scheduler
Create a task that runs:
```
wsl.exe -d Ubuntu -u yourusername -- bash -c "cd /path/to/agent-memory-proxy && AGENT_MEMORY_PATHS=/home/user/projects uv run amp"
```

#### Option 2: Background Process
Add to `~/.bashrc` or `~/.zshrc`:
```bash
# Start agent memory proxy if not running
if ! pgrep -f "amp" > /dev/null; then
    export AGENT_MEMORY_PATHS="/home/user/projects"
    cd /path/to/agent-memory-proxy && nohup uv run amp > ~/.agent-memory-proxy.log 2>&1 &
fi
```

## üìÅ Example Project Structure

```
my-project/
‚îú‚îÄ‚îÄ .amp.yaml                   # Configuration
‚îú‚îÄ‚îÄ AGENT.md                    # Your single source of truth
‚îú‚îÄ‚îÄ CLAUDE.md                   # Generated (gitignored)
‚îú‚îÄ‚îÄ GEMINI.md                   # Generated (gitignored)
‚îú‚îÄ‚îÄ .cursor/
‚îÇ   ‚îî‚îÄ‚îÄ rules/
‚îÇ       ‚îî‚îÄ‚îÄ project.mdc         # Generated (gitignored)
‚îî‚îÄ‚îÄ .gitignore
```

## üîß Advanced Configuration

### Multiple Memory Files

You can map different source files to different targets:

```yaml
respect_gitignore: true
truth_memory_file: "AGENT.md"
agents:
  - claude
  - gemini
  - cursor
```

### Watching Multiple Projects

Set multiple paths in the environment variable:

```bash
# Unix-like (colon-separated)
export AGENT_MEMORY_PATHS="/project1:/project2:/project3"

# Windows (semicolon-separated)
set AGENT_MEMORY_PATHS=C:\project1;C:\project2;C:\project3
```

## üêõ Troubleshooting

### Proxy Not Detecting Changes
- Ensure the source file exists before starting the proxy
- Check file permissions
- Verify the config file is valid YAML
- Run with `--verbose` flag for detailed logs

### Permission Errors
- On Unix systems, ensure you have read/write permissions
- On Windows, run as Administrator if needed

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

### Development Setup

1. **Clone the repository**
   ```bash
   git clone https://github.com/igor-gorohovsky/agent-memory-proxy.git
   cd agent-memory-proxy
   ```

2. **Install uv**
   ```bash
   curl -LsSf https://astral.sh/uv/install.sh | sh
   ```

3. **Install development dependencies**
   ```bash
   uv sync
   ```

4. **Run tests**
   ```bash
   uv run pytest tests
   ```

5. **Run tests on all Python versions (3.9-3.13)**
   ```bash
   # Install tox
   uv tool install tox
   
   # Run lint, type check, and tests on all supported Python versions
   tox
   
   # Run specific environments (each includes lint + type check + tests)
   tox -e py39,py310,py311,py312,py313
   
   # Run only linting or type checking (single environment)
   tox -e lint,type-check
   ```

### Development Workflow

1. Create a new branch for your feature
2. Make your changes
3. Add tests for new functionality
8. Submit a pull request

## üìÆ Support

For issues, questions, or suggestions:
- Open an issue on GitHub
- Check existing issues for solutions
- Read the logs with `--verbose` flag for debugging
